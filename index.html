<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Swatcher</title>
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet">
  <style>
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #e8e8e8;
      color: #333;
      height: 100vh;
      overflow: hidden;
    }

    #app {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    /* Header */
    #header {
      background: #fff;
      padding: 10px 20px;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      z-index: 10;
    }

    #header h1 {
      font-size: 18px;
      font-weight: 600;
      color: #1e39d2;
    }

    /* Main three-column layout */
    #main {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* Left Panel */
    #left-panel {
      width: 280px;
      min-width: 280px;
      background: #fff;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    #tab-bar {
      display: flex;
      border-bottom: 2px solid #eee;
      background: #fafafa;
    }

    .tab-btn {
      flex: 1;
      padding: 12px 8px;
      border: none;
      background: transparent;
      font-size: 12px;
      font-weight: 600;
      color: #666;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
      transition: color 0.2s, border-color 0.2s;
    }

    .tab-btn:hover {
      color: #1e39d2;
    }

    .tab-btn.active {
      color: #1e39d2;
      border-bottom-color: #1e39d2;
    }

    #tab-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }

    .tab-pane {
      display: none;
    }

    .tab-pane.active {
      display: block;
    }

    /* Canvas Area */
    #canvas-area {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f0f0f0;
      padding: 20px;
      position: relative;
    }

    /* Right Panel */
    #right-panel {
      width: 80px;
      min-width: 80px;
      background: #fff;
      border-left: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 16px 8px;
      gap: 8px;
    }

    /* Bottom Toolbar */
    #bottom-toolbar {
      background: #fff;
      padding: 12px 20px;
      border-top: 1px solid #ddd;
      display: flex;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 -1px 3px rgba(0,0,0,0.1);
    }
    /* Buttons */
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-primary {
      background: #1e39d2;
      color: #fff;
    }

    .btn-primary:hover {
      background: #1630b0;
    }

    .btn-secondary {
      background: #6c757d;
      color: #fff;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    /* Section titles */
    .section-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #333;
    }

    .section-subtitle {
      font-size: 12px;
      font-weight: 600;
      margin: 12px 0 8px;
      color: #666;
    }

    /* Upload dropzone */
    .dropzone {
      border: 2px dashed #ccc;
      border-radius: 8px;
      padding: 24px;
      text-align: center;
      color: #999;
      font-size: 13px;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
    }

    .dropzone.drag-over {
      border-color: #1e39d2;
      background: #f0f3ff;
    }

    .dropzone p {
      margin-bottom: 4px;
    }

    .dropzone-sub {
      font-size: 11px;
      margin: 8px 0 !important;
    }

    .upload-label {
      display: inline-block;
      margin-top: 8px;
    }

    /* Upload mode radios */
    .upload-mode {
      margin-top: 12px;
      display: flex;
      gap: 16px;
    }

    .radio-label {
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      color: #555;
    }

    /* Overlay gallery */
    .overlay-gallery {
      margin-top: 16px;
    }

    .thumb-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    .thumb-grid img {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      border: 2px solid #eee;
      border-radius: 4px;
      cursor: pointer;
      transition: border-color 0.2s;
    }

    .thumb-grid img:hover {
      border-color: #1e39d2;
    }

    /* Form elements */
    .form-group {
      margin-bottom: 12px;
    }

    .form-label {
      display: block;
      font-size: 11px;
      font-weight: 600;
      color: #666;
      margin-bottom: 4px;
      text-transform: uppercase;
    }

    .form-input {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s;
    }

    .form-input:focus {
      border-color: #1e39d2;
    }

    .form-select {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 13px;
      outline: none;
      background: #fff;
    }

    .form-color {
      width: 100%;
      height: 36px;
      border: 1px solid #ddd;
      border-radius: 4px;
      cursor: pointer;
      padding: 2px;
    }

    /* Style buttons */
    .style-buttons {
      display: flex;
      gap: 4px;
    }

    .style-btn {
      width: 36px;
      height: 36px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background: #fff;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, border-color 0.2s;
    }

    .style-btn:hover {
      background: #f0f3ff;
      border-color: #1e39d2;
    }

    .style-btn.active {
      background: #1e39d2;
      color: #fff;
      border-color: #1e39d2;
    }
    /* Color swatches */
    .swatch-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
    }

    .swatch {
      width: 100%;
      aspect-ratio: 1;
      border: 2px solid #ddd;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.15s, border-color 0.15s, box-shadow 0.15s;
      padding: 0;
    }

    .swatch:hover {
      transform: scale(1.1);
      border-color: #1e39d2;
    }

    .swatch.active {
      border-color: #1e39d2;
      box-shadow: 0 0 0 2px #1e39d2;
    }

    /* Quill editor container */
    .product-info-section {
      margin-top: 20px;
    }

    #quill-editor {
      min-height: 150px;
      background: #fff;
      border-radius: 0 0 4px 4px;
    }

    .product-info-section .ql-toolbar {
      border-radius: 4px 4px 0 0;
    }

    .product-info-section .ql-container {
      border-radius: 0 0 4px 4px;
      font-size: 13px;
    }
    /* Zoom controls */
    .zoom-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .zoom-label {
      font-size: 11px;
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
    }

    .zoom-btn {
      width: 40px;
      height: 40px;
      border: 1px solid #ddd;
      border-radius: 50%;
      background: #fff;
      cursor: pointer;
      font-size: 18px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, border-color 0.2s;
    }

    .zoom-btn:hover {
      background: #f0f3ff;
      border-color: #1e39d2;
    }

    .zoom-value {
      font-size: 13px;
      font-weight: 600;
      color: #333;
    }

    .zoom-reset {
      border-radius: 4px;
      width: auto;
      padding: 6px 12px;
      font-size: 11px;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <div id="app">
    <header id="header">
      <h1>Product Swatcher</h1>
    </header>
    <div id="main">
      <aside id="left-panel">
        <div id="tab-bar">
          <button class="tab-btn active" data-tab="upload">Upload</button>
          <button class="tab-btn" data-tab="text">Add Text</button>
          <button class="tab-btn" data-tab="details">Product Details</button>
        </div>
        <div id="tab-content">
          <div id="tab-upload" class="tab-pane active">
            <div class="upload-section">
              <h3 class="section-title">Upload Image</h3>

              <div id="upload-dropzone" class="dropzone">
                <p>Drag & drop image here</p>
                <p class="dropzone-sub">or</p>
                <label class="btn btn-primary upload-label">
                  Browse Files
                  <input type="file" id="file-input" accept="image/*" hidden>
                </label>
              </div>

              <div class="upload-mode">
                <label class="radio-label">
                  <input type="radio" name="upload-mode" value="overlay" checked>
                  Add as Overlay
                </label>
                <label class="radio-label">
                  <input type="radio" name="upload-mode" value="background">
                  Set as Background
                </label>
              </div>

              <div id="overlay-gallery" class="overlay-gallery">
                <h4 class="section-subtitle">Uploaded Overlays</h4>
                <div id="overlay-thumbs" class="thumb-grid"></div>
              </div>
            </div>
          </div>
          <div id="tab-text" class="tab-pane">
  <div class="text-section">
    <h3 class="section-title">Add Text</h3>

    <div class="form-group">
      <input type="text" id="text-input" class="form-input" placeholder="Enter your text...">
      <button id="add-text-btn" class="btn btn-primary" style="width:100%; margin-top:8px;">Add Text</button>
    </div>

    <div class="text-controls" id="text-controls">
      <h4 class="section-subtitle">Text Properties</h4>

      <div class="form-group">
        <label class="form-label">Font</label>
        <select id="font-family" class="form-select">
          <option value="Arial">Arial</option>
          <option value="Helvetica">Helvetica</option>
          <option value="Times New Roman">Times New Roman</option>
          <option value="Georgia">Georgia</option>
          <option value="Courier New">Courier New</option>
          <option value="Verdana">Verdana</option>
          <option value="Impact">Impact</option>
          <option value="Comic Sans MS">Comic Sans MS</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Size</label>
        <input type="number" id="font-size" class="form-input" value="24" min="8" max="120">
      </div>

      <div class="form-group">
        <label class="form-label">Color</label>
        <input type="color" id="font-color" class="form-color" value="#000000">
      </div>

      <div class="form-group">
        <label class="form-label">Style</label>
        <div class="style-buttons">
          <button id="btn-bold" class="style-btn" title="Bold"><b>B</b></button>
          <button id="btn-italic" class="style-btn" title="Italic"><i>I</i></button>
          <button id="btn-underline" class="style-btn" title="Underline"><u>U</u></button>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Align</label>
        <div class="style-buttons">
          <button class="style-btn align-btn" data-align="left" title="Left Align">&#8676;</button>
          <button class="style-btn align-btn" data-align="center" title="Center Align">&#8803;</button>
          <button class="style-btn align-btn" data-align="right" title="Right Align">&#8677;</button>
        </div>
      </div>

      <button id="delete-selected" class="btn btn-secondary" style="width:100%; margin-top:12px;">Delete Selected</button>
    </div>
  </div>
</div>
          <div id="tab-details" class="tab-pane">
  <div class="details-section">
    <h3 class="section-title">Product Details</h3>

    <div class="color-swatches-section">
      <h4 class="section-subtitle">Product Colors Available</h4>
      <div id="color-swatches" class="swatch-grid">
        <button class="swatch" data-color="#FF0000" style="background:#FF0000" title="Red"></button>
        <button class="swatch" data-color="#0000FF" style="background:#0000FF" title="Blue"></button>
        <button class="swatch" data-color="#008000" style="background:#008000" title="Green"></button>
        <button class="swatch" data-color="#FFFF00" style="background:#FFFF00" title="Yellow"></button>
        <button class="swatch" data-color="#FF8C00" style="background:#FF8C00" title="Orange"></button>
        <button class="swatch" data-color="#800080" style="background:#800080" title="Purple"></button>
        <button class="swatch" data-color="#000000" style="background:#000000" title="Black"></button>
        <button class="swatch" data-color="#FFFFFF" style="background:#FFFFFF; border-color:#ccc" title="White"></button>
      </div>
      <button id="clear-tint" class="btn btn-secondary" style="width:100%; margin-top:8px; font-size:11px;">Clear Tint</button>
    </div>

    <div class="product-info-section">
      <h4 class="section-subtitle">Product Details</h4>
      <div id="quill-editor"></div>
    </div>
  </div>
</div>
        </div>
      </aside>
      <main id="canvas-area">
        <canvas id="product-canvas"></canvas>
      </main>
      <aside id="right-panel">
        <div class="zoom-controls">
          <span class="zoom-label">Zoom</span>
          <button id="zoom-in" class="zoom-btn" title="Zoom In">+</button>
          <span id="zoom-level" class="zoom-value">100%</span>
          <button id="zoom-out" class="zoom-btn" title="Zoom Out">&minus;</button>
          <button id="zoom-reset" class="zoom-btn zoom-reset" title="Reset Zoom">Reset</button>
        </div>
      </aside>
    </div>
    <footer id="bottom-toolbar"></footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
  <script>
    // ===== APP STATE =====
    const state = {
      canvas: null,
      backgroundImage: null,
      tintOverlay: null,
      tintColor: null,
      quillEditor: null,
      zoomLevel: 1,
      uploadedOverlays: [],
    };

    // ===== CANVAS SETUP =====
    function initCanvas() {
      const area = document.getElementById('canvas-area');
      const width = Math.min(area.clientWidth - 40, 600);
      const height = Math.min(area.clientHeight - 40, 500);

      state.canvas = new fabric.Canvas('product-canvas', {
        width: width,
        height: height,
        backgroundColor: '#ffffff',
        selection: true,
        preserveObjectStacking: true,
      });

      loadDefaultBackground();
    }

    function loadDefaultBackground() {
      const canvas = state.canvas;
      const defaultBg = new fabric.Rect({
        width: canvas.width,
        height: canvas.height,
        fill: '#e0e0e0',
        selectable: false,
        evented: false,
      });

      const placeholderText = new fabric.Text('Upload a Product Image', {
        fontSize: 20,
        fill: '#999',
        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
        selectable: false,
        evented: false,
      });

      placeholderText.set({
        left: (canvas.width - placeholderText.width) / 2,
        top: (canvas.height - placeholderText.height) / 2,
      });

      const bgGroup = new fabric.Group([defaultBg, placeholderText], {
        selectable: false,
        evented: false,
        name: 'defaultBackground',
      });

      state.backgroundImage = bgGroup;
      canvas.insertAt(bgGroup, 0);
      canvas.renderAll();
    }

    function setBackgroundImage(dataUrl) {
      const canvas = state.canvas;

      fabric.Image.fromURL(dataUrl, function(img) {
        if (state.backgroundImage) {
          canvas.remove(state.backgroundImage);
        }

        const scaleX = canvas.width / img.width;
        const scaleY = canvas.height / img.height;
        const scale = Math.min(scaleX, scaleY);

        img.set({
          scaleX: scale,
          scaleY: scale,
          left: (canvas.width - img.width * scale) / 2,
          top: (canvas.height - img.height * scale) / 2,
          selectable: false,
          evented: false,
          name: 'backgroundImage',
        });

        state.backgroundImage = img;
        canvas.insertAt(img, 0);

        if (state.tintOverlay) {
          canvas.remove(state.tintOverlay);
          canvas.insertAt(state.tintOverlay, 1);
        }

        canvas.renderAll();
      });
    }

    // ===== TAB SWITCHING =====
    function initTabs() {
      const tabBtns = document.querySelectorAll('.tab-btn');
      const tabPanes = document.querySelectorAll('.tab-pane');

      tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          tabBtns.forEach(b => b.classList.remove('active'));
          tabPanes.forEach(p => p.classList.remove('active'));

          btn.classList.add('active');
          const tabId = 'tab-' + btn.dataset.tab;
          document.getElementById(tabId).classList.add('active');
        });
      });
    }

    // ===== UPLOAD FUNCTIONALITY =====
    function initUpload() {
      const dropzone = document.getElementById('upload-dropzone');
      const fileInput = document.getElementById('file-input');

      dropzone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.classList.add('drag-over');
      });

      dropzone.addEventListener('dragleave', () => {
        dropzone.classList.remove('drag-over');
      });

      dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropzone.classList.remove('drag-over');
        const file = e.dataTransfer.files[0];
        if (file && file.type.startsWith('image/')) {
          handleImageUpload(file);
        }
      });

      fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          handleImageUpload(file);
        }
        fileInput.value = '';
      });

      dropzone.addEventListener('click', (e) => {
        if (e.target.tagName !== 'INPUT') {
          fileInput.click();
        }
      });
    }

    function handleImageUpload(file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        const dataUrl = e.target.result;
        const mode = document.querySelector('input[name="upload-mode"]:checked').value;

        if (mode === 'background') {
          setBackgroundImage(dataUrl);
        } else {
          addOverlayImage(dataUrl);
          addOverlayThumbnail(dataUrl);
        }
      };
      reader.readAsDataURL(file);
    }

    function addOverlayImage(dataUrl) {
      const canvas = state.canvas;

      fabric.Image.fromURL(dataUrl, function(img) {
        const maxW = canvas.width * 0.4;
        const maxH = canvas.height * 0.4;
        const scale = Math.min(maxW / img.width, maxH / img.height, 1);

        img.set({
          scaleX: scale,
          scaleY: scale,
          left: canvas.width / 2,
          top: canvas.height / 2,
          originX: 'center',
          originY: 'center',
          name: 'overlay',
        });

        canvas.add(img);
        canvas.setActiveObject(img);
        canvas.renderAll();
      });
    }

    function addOverlayThumbnail(dataUrl) {
      state.uploadedOverlays.push(dataUrl);
      const thumbsContainer = document.getElementById('overlay-thumbs');
      const thumb = document.createElement('img');
      thumb.src = dataUrl;
      thumb.title = 'Click to add again';
      thumb.addEventListener('click', () => addOverlayImage(dataUrl));
      thumbsContainer.appendChild(thumb);
    }

    // ===== TEXT FUNCTIONALITY =====
    function initText() {
      const addBtn = document.getElementById('add-text-btn');
      const textInput = document.getElementById('text-input');
      const fontFamily = document.getElementById('font-family');
      const fontSize = document.getElementById('font-size');
      const fontColor = document.getElementById('font-color');
      const btnBold = document.getElementById('btn-bold');
      const btnItalic = document.getElementById('btn-italic');
      const btnUnderline = document.getElementById('btn-underline');
      const deleteBtn = document.getElementById('delete-selected');

      addBtn.addEventListener('click', () => {
        const text = textInput.value.trim();
        if (!text) return;

        const itext = new fabric.IText(text, {
          left: state.canvas.width / 2,
          top: state.canvas.height / 2,
          originX: 'center',
          originY: 'center',
          fontFamily: fontFamily.value,
          fontSize: parseInt(fontSize.value),
          fill: fontColor.value,
          fontWeight: btnBold.classList.contains('active') ? 'bold' : 'normal',
          fontStyle: btnItalic.classList.contains('active') ? 'italic' : 'normal',
          underline: btnUnderline.classList.contains('active'),
          name: 'userText',
        });

        state.canvas.add(itext);
        state.canvas.setActiveObject(itext);
        state.canvas.renderAll();
        textInput.value = '';
      });

      btnBold.addEventListener('click', () => {
        btnBold.classList.toggle('active');
        updateActiveTextStyle('fontWeight', btnBold.classList.contains('active') ? 'bold' : 'normal');
      });

      btnItalic.addEventListener('click', () => {
        btnItalic.classList.toggle('active');
        updateActiveTextStyle('fontStyle', btnItalic.classList.contains('active') ? 'italic' : 'normal');
      });

      btnUnderline.addEventListener('click', () => {
        btnUnderline.classList.toggle('active');
        updateActiveTextStyle('underline', btnUnderline.classList.contains('active'));
      });

      fontFamily.addEventListener('change', () => {
        updateActiveTextStyle('fontFamily', fontFamily.value);
      });

      fontSize.addEventListener('change', () => {
        updateActiveTextStyle('fontSize', parseInt(fontSize.value));
      });

      fontColor.addEventListener('input', () => {
        updateActiveTextStyle('fill', fontColor.value);
      });

      document.querySelectorAll('.align-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          updateActiveTextStyle('textAlign', btn.dataset.align);
        });
      });

      deleteBtn.addEventListener('click', () => {
        const active = state.canvas.getActiveObject();
        if (active && active.name !== 'defaultBackground' && active.name !== 'backgroundImage' && active.name !== 'tintOverlay') {
          state.canvas.remove(active);
          state.canvas.renderAll();
        }
      });

      state.canvas.on('selection:created', updateTextControls);
      state.canvas.on('selection:updated', updateTextControls);
    }

    function updateActiveTextStyle(property, value) {
      const active = state.canvas.getActiveObject();
      if (active && (active.type === 'i-text' || active.type === 'text')) {
        active.set(property, value);
        state.canvas.renderAll();
      }
    }

    function updateTextControls() {
      const active = state.canvas.getActiveObject();
      if (!active || (active.type !== 'i-text' && active.type !== 'text')) return;

      document.getElementById('font-family').value = active.fontFamily || 'Arial';
      document.getElementById('font-size').value = active.fontSize || 24;
      document.getElementById('font-color').value = active.fill || '#000000';

      document.getElementById('btn-bold').classList.toggle('active', active.fontWeight === 'bold');
      document.getElementById('btn-italic').classList.toggle('active', active.fontStyle === 'italic');
      document.getElementById('btn-underline').classList.toggle('active', !!active.underline);
    }

    // ===== PRODUCT DETAILS FUNCTIONALITY =====
    function initProductDetails() {
      state.quillEditor = new Quill('#quill-editor', {
        theme: 'snow',
        placeholder: 'Enter product details, specs, or notes...',
        modules: {
          toolbar: [
            [{ 'header': [1, 2, 3, false] }],
            ['bold', 'italic', 'underline'],
            [{ 'list': 'ordered' }, { 'list': 'bullet' }],
            [{ 'color': [] }],
            ['clean'],
          ],
        },
      });

      const swatches = document.querySelectorAll('.swatch');
      swatches.forEach(swatch => {
        swatch.addEventListener('click', () => {
          swatches.forEach(s => s.classList.remove('active'));
          swatch.classList.add('active');
          applyTint(swatch.dataset.color);
        });
      });

      document.getElementById('clear-tint').addEventListener('click', () => {
        swatches.forEach(s => s.classList.remove('active'));
        removeTint();
      });
    }

    function applyTint(color) {
      const canvas = state.canvas;

      if (state.tintOverlay) {
        canvas.remove(state.tintOverlay);
      }

      const tint = new fabric.Rect({
        width: canvas.width,
        height: canvas.height,
        fill: color,
        opacity: 0.25,
        selectable: false,
        evented: false,
        name: 'tintOverlay',
      });

      state.tintOverlay = tint;
      state.tintColor = color;

      canvas.insertAt(tint, 1);
      canvas.renderAll();
    }

    function removeTint() {
      if (state.tintOverlay) {
        state.canvas.remove(state.tintOverlay);
        state.tintOverlay = null;
        state.tintColor = null;
        state.canvas.renderAll();
      }
    }

    // ===== ZOOM FUNCTIONALITY =====
    function initZoom() {
      document.getElementById('zoom-in').addEventListener('click', () => {
        setZoom(state.zoomLevel + 0.1);
      });

      document.getElementById('zoom-out').addEventListener('click', () => {
        setZoom(state.zoomLevel - 0.1);
      });

      document.getElementById('zoom-reset').addEventListener('click', () => {
        setZoom(1);
      });
    }

    function setZoom(level) {
      level = Math.max(0.25, Math.min(3, level));
      state.zoomLevel = level;
      state.canvas.setZoom(level);
      document.getElementById('zoom-level').textContent = Math.round(level * 100) + '%';
      state.canvas.renderAll();
    }

    // ===== INIT =====
    document.addEventListener('DOMContentLoaded', () => {
      initCanvas();
      initTabs();
      initUpload();
      initText();
      initProductDetails();
      initZoom();
    });
  </script>
</body>
</html>
